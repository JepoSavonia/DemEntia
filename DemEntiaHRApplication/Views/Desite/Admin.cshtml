@{
    ViewData["Title"] = "Admin";
}

@model UserModel
<h2>Ylläpitäjä</h2>

    <br />
    <p>Käyttäjänimi : @Model.AdminUser.Username</p>
    <p>Nimi : @Model.AdminUser.DisplayName</p>
    <p>Sähköposti : @Model.AdminUser.Email</p>
    <p>Title : @Model.AdminUser.Title</p>
    <div class="edit-div">
        <p>@ViewData["updateError"]</p>
        <button id="editBtn" class="btn btn-link">Muokkaa</button>
    </div>
    
    <br />
    <div class="adminAddUserCon">
        <p>@ViewData["message"]</p>
        <button id="addUserBtn" type="button" class="adminAddUserBtn btn btn-success" >Lisää käyttäjä</button>
        <p>@ViewData["userFoundMessage"]</p>
    </div>
    <br />
    <div class="searchCon">
        <form asp-action="Admin" method="get">

            <input class="form-control newPass" type="text" name="username" placeholder="Käyttäjänimi" required style="display:inline-block;"/>
            <input id="searchButton" class="btn btn-success" type="submit" value="Hae" style="display:inline-block;"/>
            <br />
        </form>
        <p style="color:red">@ViewData["userNotFound"]</p>
        <br />
        <div id="resultDiv" style="display: @ViewData["display"];">
            <form asp-action="Admin" method="post">
                <table>
                    <tr>
                        <td><label asp-for="UserObject.Username" ></label></td>
                        <td><input asp-for="UserObject.Username" class="form-control"/><input asp-for="UserObject.Username" type="hidden" /></td>
                    </tr>

                    <tr>
                        <td><label asp-for="UserObject.Name"></label></td>
                        <td><input asp-for="UserObject.Name" class="form-control" required/></td>
                    </tr>

                    <tr>
                        <td><label asp-for="UserObject.Surname"></label></td>
                        <td><input asp-for="UserObject.Surname" class="form-control" required/></td>
                    </tr>
                    <tr>
                        <td><label asp-for="UserObject.Title"></label></td>
                        <td><input asp-for="UserObject.Title" class="form-control" required/></td>
                    </tr>
                    <tr>
                        <td><label asp-for="UserObject.IsEnabled"></label></td>
                        <td><input asp-for="UserObject.IsEnabled"/></td>
                    </tr>

                </table>
                <input class="btn btn-success" type="submit" name="update" value="Päivitä" />
            </form>
            <br />

            <p>@ViewData["updateMessage"]</p>

            <br />
            <form asp-action="ResetPass" method="post">
                <table>
                    <tr>
                        <td><label>Nollaa salasana</label></td>
                        <td><input class="form-control" asp-for="UserObject.Password" type="password" placeholder="Uusi salasana" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{10,}" title="Must contain at least one number and one uppercase and lowercase letter, and at least 10 or more characters" required /></td>
                    </tr>
                </table>
                <input asp-for="UserObject.Username" type="hidden" />
                <input asp-for="UserObject.Name" type="hidden" />
                <input asp-for="UserObject.Surname" type="hidden" />
                <input asp-for="UserObject.Title" type="hidden" />
                <input asp-for="UserObject.IsEnabled" type="hidden" />
                <input class="btn btn-success" type="submit" name="resetPass" value="Tallenna" />
            </form>
            <br />
            <p>@ViewData["resetPassMessage"]</p>

        </div>
    </div>
    
    <div id="myModal" class="modal">

        <div class="modal-content">
            <span class="close">&times;</span>
            
            <h3>Lisää uusi käyttäjä</h3>
            <br />
            <form asp-action="CreateUser" method="post">
                <table>
                    <tr>
                        <td><label asp-for="CreateUser.Username"></label></td>
                        <td><input asp-for="CreateUser.Username" class="form-control" placeholder="Käyttäjänimi" required /></td>
                    </tr>
                    <tr>
                        <td><label asp-for="CreateUser.Name"></label></td>
                        <td><input asp-for="CreateUser.Name" class="form-control" placeholder="Etunimi" required /></td>
                    </tr>
                    <tr>
                        <td><label asp-for="CreateUser.Surname"></label></td>
                        <td><input asp-for="CreateUser.Surname" class="form-control" placeholder="Sukunimi" required /></td>
                    </tr>
                    <tr>
                        <td><label asp-for="CreateUser.IsEnabled"></label></td>
                        <td><input asp-for="CreateUser.IsEnabled" class="checkbox" /></td>
                    </tr>
                    <tr>
                        <td><label asp-for="CreateUser.Password"></label></td>
                        <td><input asp-for="CreateUser.Password" class="form-control" placeholder="Salasana" type="password" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{10,}" title="Must contain at least one number and one uppercase and lowercase letter, and at least 10 or more characters" required /></td>
                    </tr>
                </table>
                <br />
                <p>@ViewData["passwordError"]</p>
                <input class="btn btn-success" type="submit" name="createUser" value="Lisää käyttäjä" />
            </form>
        </div>
    </div>

    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>

            <h3>Muokkaa käyttäjää</h3>
            <br />

            <form asp-action="UpdateAdmin" method="post">
                <label asp-for="AdminUser.Username"></label>
                <input asp-for="AdminUser.Username" class="form-control" />

                <label asp-for="AdminUser.Name"></label>
                <input asp-for="AdminUser.Name" class="form-control" />

                <label asp-for="AdminUser.Surname"></label>
                <input asp-for="AdminUser.Surname" class="form-control" />

                <label asp-for="AdminUser.Title"></label>
                <input asp-for="AdminUser.Title" class="form-control" />

                <input type="submit" class="btn btn-success" value="Tallenna"/>
            </form>
        </div>
    </div>

@section scripts{
    <script>

        var createUserModal = document.getElementById('myModal');
        var createBtn = document.getElementById("addUserBtn");
        var span = document.getElementsByClassName("close")[0];

        createBtn.onclick = function () {
            createUserModal.style.display = "block";
        }

        span.onclick = function () {
            createUserModal.style.display = "none";
        }

        window.onclick = function (event) {
            if (event.target == createUserModal) {

                createUserModal.style.display = "none";

            }else if (event.target == editAdminUserModal) {

                editAdminUserModal.style.display = "none";

            }
        }

        var editAdminUserModal = document.getElementById('editModal');
        var editBtn = document.getElementById("editBtn");
        var span2 = document.getElementsByClassName("close")[1];

        editBtn.onclick = function () {
            editAdminUserModal.style.display = "block";
        }

        span2.onclick = function () {
            editAdminUserModal.style.display = "none";
        }
    </script>
}